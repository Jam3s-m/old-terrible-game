/// platform physics

var rkey = keyboard_check (vk_right);
var lkey = keyboard_check (vk_left);
var jkey = keyboard_check (vk_up);

// Check for ground
if (place_meeting(x, y+1, object_solid)) {
    vspd = 0;
    
    //Jumping
    if (jkey) {
        vspd = -jspd;
    
    }
} else {
    //Gravity
    if (vspd < 10) {
        vspd += grav;
    } 
}

//Moving right
if (rkey) {
    hspd = spd;
}

//Moving left
if (lkey) {
    hspd = -spd;
}

//Check for not moving
if ((!rkey && !lkey) || (rkey && lkey)) {
     hspd = 0;
}

//Horizontal collisions
if (place_meeting(x+hspd, y , object_solid)) {
    while (!place_meeting(x+sign(hspd), y, object_solid)) {
        x+= sign(hspd) ;
    }
    hspd = 0;
}

//Move Horizontally
x += hspd;

//Vertical collisions
if (place_meeting(x, y+vspd, object_solid)) {
    while (!place_meeting(x, y+sign(vspd), object_solid)) {
        y += sign(vspd)
        }
        vspd = 0;
}

//Move Vertically
y += vspd;

//Control the sprites
if (yprevious != y) {
    sprite_index = spr_player_jump;
    image_speed = 0;
    image_index = y>yprevious;
} else {
    if (xprevious != x) {
        sprite_index = spr_player_run;
        image_speed = .3;
    } else {
        sprite_index = spr_player_stand;
    }    
}

//Control the direction the player is facing
if (xprevious < x) {
    image_xscale = 1;
} else if (xprevious > x) {
    image_xscale = -1;
}
